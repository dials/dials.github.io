


<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>dials.algorithms.symmetry &#8212; DIALS  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <link rel="stylesheet" href="../../../_static/dials-styles.css" type="text/css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="dxtbx" href="../dxtbx/index.html" />
    <link rel="prev" title="dials.algorithms.spot_prediction" href="dials.algorithms.spot_prediction.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="logoheader container">
  <a href="../../../index.html">
  <img class="logoheader" alt="DIALS" src="../../../_static/dials_header.png" />
  </a>
  </div>
  

  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-dials.algorithms.symmetry">
<span id="dials-algorithms-symmetry"></span><h1>dials.algorithms.symmetry<a class="headerlink" href="#module-dials.algorithms.symmetry" title="Permalink to this heading">¶</a></h1>
<p>Methods for symmetry determination.</p>
<p>This module provides a base class for symmetry determination algorithms.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.resolution_filter_from_array">
<span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.</span></span><span class="sig-name descname"><span class="pre">resolution_filter_from_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_i_mean_over_sigma_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cc_half</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry.html#resolution_filter_from_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.resolution_filter_from_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the resolution filter using miller array data format.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.resolution_filter_from_reflections_experiments">
<span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.</span></span><span class="sig-name descname"><span class="pre">resolution_filter_from_reflections_experiments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reflections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_i_mean_over_sigma_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cc_half</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry.html#resolution_filter_from_reflections_experiments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.resolution_filter_from_reflections_experiments" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the resolution filter using native dials data formats.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.symmetry_base">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.</span></span><span class="sig-name descname"><span class="pre">symmetry_base</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalisation='ml_aniso'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_symmetry_max_delta=2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_min=&lt;libtbx.AutoType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_i_mean_over_sigma_mean=4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cc_half=0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_length_tolerance=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_angle_tolerance=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_monoclinic_beta=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry.html#symmetry_base"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.symmetry_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for symmetry analysis.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.symmetry_base.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalisation='ml_aniso'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_symmetry_max_delta=2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_min=&lt;libtbx.AutoType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_i_mean_over_sigma_mean=4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cc_half=0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_length_tolerance=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_angle_tolerance=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_monoclinic_beta=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry.html#symmetry_base.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.symmetry_base.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a symmetry_base object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>intensities</strong> (<a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.miller.html#cctbx.miller.array" title="(in CCTBX vNone)"><em>cctbx.miller.array</em></a>) – The intensities on which to perform
symmetry analysis.</p></li>
<li><p><strong>normalisation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – The normalisation method to use. Possible choices are
‘kernel’, ‘quasi’, ‘ml_iso’ and ‘ml_aniso’. Set to None to switch off
normalisation altogether.</p></li>
<li><p><strong>lattice_symmetry_max_delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The maximum value of delta for
determining the lattice symmetry using the algorithm of Le Page (1982).</p></li>
<li><p><strong>d_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Optional resolution cutoff to be applied to the input
intensities. If set to <code class="xref py py-data docutils literal notranslate"><span class="pre">libtbx.Auto</span></code> then d_min will be
automatically determined according to the parameters
<code class="docutils literal notranslate"><span class="pre">min_i_mean_over_sigma_mean</span></code> and <code class="docutils literal notranslate"><span class="pre">min_cc_half</span></code>.</p></li>
<li><p><strong>min_i_mean_over_sigma_mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – minimum value of <span class="math notranslate nohighlight">\(|I|/|sigma(I)|\)</span> for
automatic determination of resolution cutoff.</p></li>
<li><p><strong>min_cc_half</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – minimum value of CC½ for automatic determination of
resolution cutoff.</p></li>
<li><p><strong>relative_length_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Relative length tolerance in checking
consistency of input unit cells against the median unit cell.</p></li>
<li><p><strong>absolute_angle_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Absolute angle tolerance in checking
consistency of input unit cells against the median unit cell.</p></li>
<li><p><strong>best_monoclinic_beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – If True, then for monoclinic centered cells, I2
will be preferred over C2 if it gives a less oblique cell (i.e. smaller
beta angle).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.symmetry_base.kernel_normalisation">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kernel_normalisation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry.html#symmetry_base.kernel_normalisation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.symmetry_base.kernel_normalisation" title="Permalink to this definition">¶</a></dt>
<dd><p>Kernel normalisation of the input intensities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>intensities</strong> (<a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.miller.html#cctbx.miller.array" title="(in CCTBX vNone)"><em>cctbx.miller.array</em></a>) – The intensities to be normalised.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The normalised intensities.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.miller.html#cctbx.miller.array" title="(in CCTBX vNone)">cctbx.miller.array</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.symmetry_base.ml_aniso_normalisation">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ml_aniso_normalisation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry.html#symmetry_base.ml_aniso_normalisation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.symmetry_base.ml_aniso_normalisation" title="Permalink to this definition">¶</a></dt>
<dd><p>Anisotropic maximum-likelihood normalisation of the input intensities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>intensities</strong> (<a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.miller.html#cctbx.miller.array" title="(in CCTBX vNone)"><em>cctbx.miller.array</em></a>) – The intensities to be normalised.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The normalised intensities.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.miller.html#cctbx.miller.array" title="(in CCTBX vNone)">cctbx.miller.array</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.symmetry_base.ml_iso_normalisation">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ml_iso_normalisation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry.html#symmetry_base.ml_iso_normalisation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.symmetry_base.ml_iso_normalisation" title="Permalink to this definition">¶</a></dt>
<dd><p>Isotropic maximum-likelihood normalisation of the input intensities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>intensities</strong> (<a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.miller.html#cctbx.miller.array" title="(in CCTBX vNone)"><em>cctbx.miller.array</em></a>) – The intensities to be normalised.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The normalised intensities.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.miller.html#cctbx.miller.array" title="(in CCTBX vNone)">cctbx.miller.array</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-dials.algorithms.symmetry.laue_group"></span><p>Algorithms for determination of Laue group symmetry.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.CorrelationCoefficientAccumulator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.laue_group.</span></span><span class="sig-name descname"><span class="pre">CorrelationCoefficientAccumulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#CorrelationCoefficientAccumulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.CorrelationCoefficientAccumulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for incremental computation of correlation coefficients.</p>
<dl class="simple">
<dt>Uses the single-pass formula for Pearson correlation coefficient:</dt><dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient#For_a_sample">https://en.wikipedia.org/wiki/Pearson_correlation_coefficient#For_a_sample</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.CorrelationCoefficientAccumulator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#CorrelationCoefficientAccumulator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.CorrelationCoefficientAccumulator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a CorrelationCoefficientAccumulator object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – Optional list of <cite>x</cite> values to initialise the accumulator.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – Optional list of <cite>y</cite> values to initialise the accumulator.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.CorrelationCoefficientAccumulator.accumulate">
<span class="sig-name descname"><span class="pre">accumulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#CorrelationCoefficientAccumulator.accumulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.CorrelationCoefficientAccumulator.accumulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Accumulate the <cite>x</cite> and <cite>y</cite> values provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – The list of <cite>x</cite> values to accumulate.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – The list of <cite>y</cite> values to accumulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.CorrelationCoefficientAccumulator.coefficient">
<span class="sig-name descname"><span class="pre">coefficient</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#CorrelationCoefficientAccumulator.coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.CorrelationCoefficientAccumulator.coefficient" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the correlation coefficient.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The correlation coefficient.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.CorrelationCoefficientAccumulator.denominator">
<span class="sig-name descname"><span class="pre">denominator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#CorrelationCoefficientAccumulator.denominator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.CorrelationCoefficientAccumulator.denominator" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the denominator of the correlation coefficient formula.</p>
<div class="math notranslate nohighlight">
\[\sqrt{n \sum{x^2} - \sum{x}^2} \sqrt{n \sum{y^2} - \sum{y}^2}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The value of the denominator.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.CorrelationCoefficientAccumulator.n">
<span class="sig-name descname"><span class="pre">n</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#CorrelationCoefficientAccumulator.n"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.CorrelationCoefficientAccumulator.n" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of values contributing to the correlation coefficient.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>n (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.CorrelationCoefficientAccumulator.numerator">
<span class="sig-name descname"><span class="pre">numerator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#CorrelationCoefficientAccumulator.numerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.CorrelationCoefficientAccumulator.numerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the numerator of the correlation coefficient formula.</p>
<div class="math notranslate nohighlight">
\[n \sum{x y} - \sum{x} \sum{y}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The value of the numerator.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.LaueGroupAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.laue_group.</span></span><span class="sig-name descname"><span class="pre">LaueGroupAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalisation='ml_aniso'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_symmetry_max_delta=2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_min=&lt;libtbx.AutoType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_i_mean_over_sigma_mean=4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cc_half=0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_length_tolerance=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_angle_tolerance=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_monoclinic_beta=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#LaueGroupAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.LaueGroupAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dials.algorithms.symmetry.symmetry_base" title="dials.algorithms.symmetry.symmetry_base"><code class="xref py py-class docutils literal notranslate"><span class="pre">symmetry_base</span></code></a></p>
<p>Determination of Laue group symmetry using algorithms similar to POINTLESS.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://doi.org/10.1107/S0907444905036693">Evans, P. (2006). Acta Cryst. D62, 72-82</a> and
<a class="reference external" href="https://doi.org/10.1107/S090744491003982X">Evans, P. R. (2011). Acta Cryst. D67, 282-292</a>.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.LaueGroupAnalysis.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalisation='ml_aniso'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_symmetry_max_delta=2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_min=&lt;libtbx.AutoType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_i_mean_over_sigma_mean=4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cc_half=0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_length_tolerance=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_angle_tolerance=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_monoclinic_beta=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#LaueGroupAnalysis.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.LaueGroupAnalysis.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a LaueGroupAnalysis object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>intensities</strong> (<a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.miller.html#cctbx.miller.array" title="(in CCTBX vNone)"><em>cctbx.miller.array</em></a>) – The intensities on which to perform
symmetry analysis.</p></li>
<li><p><strong>normalisation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – The normalisation method to use. Possible choices are
‘kernel’, ‘quasi’, ‘ml_iso’ and ‘ml_aniso’. Set to None to switch off
normalisation altogether.</p></li>
<li><p><strong>lattice_symmetry_max_delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The maximum value of delta for
determining the lattice symmetry using the algorithm of Le Page (1982).</p></li>
<li><p><strong>d_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Optional resolution cutoff to be applied to the input
intensities. If set to <code class="xref py py-data docutils literal notranslate"><span class="pre">libtbx.Auto</span></code> then d_min will be
automatically determined according to the parameters
<code class="docutils literal notranslate"><span class="pre">min_i_mean_over_sigma_mean</span></code> and <code class="docutils literal notranslate"><span class="pre">min_cc_half</span></code>.</p></li>
<li><p><strong>min_i_mean_over_sigma_mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – minimum value of <span class="math notranslate nohighlight">\(|I|/|sigma(i)|\)</span> for
automatic determination of resolution cutoff.</p></li>
<li><p><strong>min_cc_half</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – minimum value of CC1/2 for automatic determination of
resolution cutoff.</p></li>
<li><p><strong>relative_length_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Relative length tolerance in checking
consistency of input unit cells against the median unit cell.</p></li>
<li><p><strong>absolute_angle_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Absolute angle tolerance in checking
consistency of input unit cells against the median unit cell.</p></li>
<li><p><strong>best_monoclinic_beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – If True, then for monoclinic centered cells, I2
will be preferred over C2 if it gives a less oblique cell (i.e. smaller
beta angle).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.LaueGroupAnalysis.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#LaueGroupAnalysis.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.LaueGroupAnalysis.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary representation of the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.LaueGroupAnalysis.as_json">
<span class="sig-name descname"><span class="pre">as_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#LaueGroupAnalysis.as_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.LaueGroupAnalysis.as_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a json representation of the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Optional filename to export the json representation of
the results.</p></li>
<li><p><strong>indent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – The indent level for pretty-printing of the json. If <code class="docutils literal notranslate"><span class="pre">None</span></code>
is the most compact representation.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.ScoreCorrelationCoefficient">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.laue_group.</span></span><span class="sig-name descname"><span class="pre">ScoreCorrelationCoefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#ScoreCorrelationCoefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.ScoreCorrelationCoefficient" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.ScoreCorrelationCoefficient.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#ScoreCorrelationCoefficient.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.ScoreCorrelationCoefficient.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.ScoreCorrelationCoefficient.p_cc_given_not_s">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">p_cc_given_not_s</span></span><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.ScoreCorrelationCoefficient.p_cc_given_not_s" title="Permalink to this definition">¶</a></dt>
<dd><p>Probability of observing this CC if the sym op is NOT present, p(CC; !S).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.ScoreCorrelationCoefficient.p_cc_given_s">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">p_cc_given_s</span></span><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.ScoreCorrelationCoefficient.p_cc_given_s" title="Permalink to this definition">¶</a></dt>
<dd><p>Probability of observing this CC if the sym op is present, p(CC; S).</p>
<p>Modelled by a Cauchy distribution centred on cc_true and width gamma = sigma_cc</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.ScoreCorrelationCoefficient.p_s_given_cc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">p_s_given_cc</span></span><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.ScoreCorrelationCoefficient.p_s_given_cc" title="Permalink to this definition">¶</a></dt>
<dd><p>The likelihood of this symmetry element being present.</p>
<p>p(S; CC) = p(CC; S) / (p(CC; S) + p(CC; !S))</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.ScoreSubGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.laue_group.</span></span><span class="sig-name descname"><span class="pre">ScoreSubGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subgroup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_op_scores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#ScoreSubGroup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.ScoreSubGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Score the probability of a given subgroup being the true subgroup.</p>
<ol class="arabic simple">
<li><p>Calculates the combined correlation coefficients for symmetry operations
present/absent from the subgroup.</p></li>
<li><p>Calculates overall Zcc scores for symmetry elements present/absent from
the subgroup.</p></li>
<li><p>Calculates the overall likelihood for this subgroup.</p></li>
</ol>
<p>See appendix A2 of <a class="reference external" href="https://doi.org/10.1107/S090744491003982X">Evans, P. R. (2011). Acta Cryst. D67, 282-292.</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.ScoreSubGroup.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subgroup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_op_scores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#ScoreSubGroup.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.ScoreSubGroup.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a ScoreSubGroup object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subgroup</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – A dictionary describing the subgroup as generated by
<a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.sgtbx.lattice_symmetry.html#cctbx.sgtbx.lattice_symmetry.metric_subgroups" title="(in CCTBX vNone)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cctbx.sgtbx.lattice_symmetry.metric_subgroups</span></code></a>.</p></li>
<li><p><strong>sym_op_scores</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – A list of <a class="reference internal" href="#dials.algorithms.symmetry.laue_group.ScoreSymmetryElement" title="dials.algorithms.symmetry.laue_group.ScoreSymmetryElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScoreSymmetryElement</span></code></a> objects for each
symmetry element possibly in the lattice symmetry.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.ScoreSubGroup.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#ScoreSubGroup.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.ScoreSubGroup.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary representation of the subgroup scoring.</p>
<dl class="simple">
<dt>The dictionary will contain the following keys:</dt><dd><ul class="simple">
<li><p>patterson_group: The current subgroup</p></li>
<li><p>likelihood: The likelihood of the subgroup being correct</p></li>
<li><p>confidence: The confidence of the subgroup being correct</p></li>
<li><p>z_cc_for: The combined Z-scores for all symmetry elements present in the
subgroup</p></li>
<li><p>z_cc_against: The combined Z-scores for all symmetry elements present in
the lattice group but not in the subgroup</p></li>
<li><p>z_cc_net: The net Z-score, i.e. z_cc_for - z_cc_against</p></li>
<li><p>cc_for: The overall correlation coefficient for all symmetry elements
present in the subgroup</p></li>
<li><p>cc_against: The overall correlation coefficient for all symmetry
elements present in the lattice group but not in the subgroup</p></li>
<li><p>max_angular_difference: The maximum angular difference between the
symmetrised unit cell and the P1 unit cell.</p></li>
<li><p>cb_op: The change of basis operation from the input unit cell to the
‘best’ unit cell.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.ScoreSymmetryElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.laue_group.</span></span><span class="sig-name descname"><span class="pre">ScoreSymmetryElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc_sig_fac</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#ScoreSymmetryElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.ScoreSymmetryElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Analyse intensities for presence of a given symmetry operation.</p>
<ol class="arabic simple">
<li><p>Calculate the correlation coefficient, CC, for the given sym op.</p></li>
<li><p>Calculate the probability of observing this CC if the sym op is present,
p(CC; S), modelled by a Cauchy distribution centred on cc_true and width
gamma = sigma_cc.</p></li>
<li><p>Calculate the probability of observing this CC if the sym op is
NOT present, p(CC; !S).</p></li>
<li><p>Calculate the likelihood of symmetry element being present,
p(S; CC) = p(CC; S) / (p(CC; S) + p(CC; !S))</p></li>
</ol>
<p>See appendix A1 of <a class="reference external" href="https://doi.org/10.1107/S090744491003982X">Evans, P. R. (2011). Acta Cryst. D67, 282-292.</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.ScoreSymmetryElement.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc_sig_fac</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#ScoreSymmetryElement.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.ScoreSymmetryElement.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a ScoreSymmetryElement object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>intensities</strong> (<a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.miller.html#cctbx.miller.array" title="(in CCTBX vNone)"><em>cctbx.miller.array</em></a>) – The intensities on which to perform
symmetry analysis.</p></li>
<li><p><strong>sym_op</strong> (<em>cctbx.sgtbx.rt_mx</em>) – The symmetry operation for analysis.</p></li>
<li><p><strong>cc_true</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the expected value of CC if the symmetry element is present,
E(CC; S)</p></li>
<li><p><strong>cc_sig_fac</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Estimation of sigma(CC) as a function of sample size.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.ScoreSymmetryElement.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#ScoreSymmetryElement.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.ScoreSymmetryElement.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary representation of the symmetry element scoring.</p>
<dl class="simple">
<dt>The dictionary will contain the following keys:</dt><dd><ul class="simple">
<li><p>likelihood: The likelihood of the symmetry element being present</p></li>
<li><p>z_cc: The Z-score for the correlation coefficient</p></li>
<li><p>cc: The correlation coefficient for the symmetry element</p></li>
<li><p>n_ref: The number of reflections contributing to the correlation
coefficient</p></li>
<li><p>operator: The xyz representation of the symmetry element</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.laue_group.trunccauchy_pdf">
<span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.laue_group.</span></span><span class="sig-name descname"><span class="pre">trunccauchy_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/laue_group.html#trunccauchy_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.laue_group.trunccauchy_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a truncated Cauchy probability density function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The point at which to calculate the PDF.</p></li>
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The lower bound of the truncated distribution.</p></li>
<li><p><strong>b</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The upper bound of the truncated distribution.</p></li>
<li><p><strong>loc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The location parameter for the Cauchy distribution.</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The scale parameter for the Cauchy distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the probability density function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-dials.algorithms.symmetry.reindex_to_reference"></span><p>Functions to help with reindexing against a reference dataset.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.reindex_to_reference.determine_reindex_operator_against_reference">
<span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.reindex_to_reference.</span></span><span class="sig-name descname"><span class="pre">determine_reindex_operator_against_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_miller_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_miller_set</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/reindex_to_reference.html#determine_reindex_operator_against_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.reindex_to_reference.determine_reindex_operator_against_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Reindex a miller set to match a reference miller set.</p>
<p>This function takes two miller arrays, a reference and a test array. The
space group is checked to see if any reindexing may be required to give
consistent indexing between both datasets. If possible twin operators exist,
the different indexing options are tested against the reference set, using
the correlation between datasets as the test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_miller_set</strong> (<a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.miller.html#cctbx.miller.array" title="(in CCTBX vNone)"><em>cctbx.miller.array</em></a>) – The input miller set to be reindexed.</p></li>
<li><p><strong>reference_miller_set</strong> (<a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.miller.html#cctbx.miller.array" title="(in CCTBX vNone)"><em>cctbx.miller.array</em></a>) – The reference miller set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The change of basis operator which should be
applied to the test dataset to give consistent indexing with the reference.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>cctbx.sgtbx.change_of_basis_op</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dials.algorithms.symmetry.cosym">
<span id="dials-algorithms-symmetry-cosym"></span><h1>dials.algorithms.symmetry.cosym<a class="headerlink" href="#module-dials.algorithms.symmetry.cosym" title="Permalink to this heading">¶</a></h1>
<p>Methods for symmetry determination from partial datasets.</p>
<p>This module implements the methods of <a class="reference external" href="https://doi.org/10.1107/S2059798318002978">Gildea, R. J. &amp; Winter, G. (2018).
Acta Cryst. D74, 405-410</a> for
determination of Patterson group symmetry from sparse multi-crystal data sets in
the presence of an indexing ambiguity.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.CosymAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.cosym.</span></span><span class="sig-name descname"><span class="pre">CosymAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#CosymAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.CosymAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dials.algorithms.symmetry.symmetry_base" title="dials.algorithms.symmetry.symmetry_base"><code class="xref py py-class docutils literal notranslate"><span class="pre">symmetry_base</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Subject</span></code></p>
<p>Perform cosym analysis.</p>
<p>Perform cosym analysis on the input intensities using the methods of
<a class="reference external" href="https://doi.org/10.1107/S2059798318002978">Gildea, R. J. &amp; Winter, G. (2018). Acta Cryst. D74, 405-410</a> for
determination of Patterson group symmetry from sparse multi-crystal data sets in
the presence of an indexing ambiguity.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.CosymAnalysis.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#CosymAnalysis.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.CosymAnalysis.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a CosymAnalysis object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>intensities</strong> (<a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.miller.html#cctbx.miller.array" title="(in CCTBX vNone)"><em>cctbx.miller.array</em></a>) – The intensities on which to perform
cosym analysis.</p></li>
<li><p><strong>params</strong> (<em>libtbx.phil.scope_extract</em>) – Parameters for the analysis.</p></li>
<li><p><strong>seed_dataset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – The index into the intensities list to use when
choosing a seed dataset for the reindexing analysis (the x,y,z reindex
mode will be used for this dataset).
If None, a high density cluster point is chosen.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.CosymAnalysis.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#CosymAnalysis.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.CosymAnalysis.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary representation of the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.CosymAnalysis.as_json">
<span class="sig-name descname"><span class="pre">as_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#CosymAnalysis.as_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.CosymAnalysis.as_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a json representation of the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Optional filename to export the json representation of
the results.</p></li>
<li><p><strong>indent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – The indent level for pretty-printing of the json. If <code class="docutils literal notranslate"><span class="pre">None</span></code>
is the most compact representation.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.CosymAnalysis.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#CosymAnalysis.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.CosymAnalysis.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.ScoreSubGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.cosym.</span></span><span class="sig-name descname"><span class="pre">ScoreSubGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subgroup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_op_scores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#ScoreSubGroup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.ScoreSubGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Score the probability of a given subgroup being the true subgroup.</p>
<ol class="arabic simple">
<li><p>Calculates overall Zcc scores for symmetry elements present/absent from
the subgroup.</p></li>
<li><p>Calculates the overall likelihood for this subgroup.</p></li>
</ol>
<p>See appendix A2 of <a class="reference external" href="https://doi.org/10.1107/S090744491003982X">Evans, P. R. (2011). Acta Cryst. D67, 282-292.</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.ScoreSubGroup.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subgroup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_op_scores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#ScoreSubGroup.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.ScoreSubGroup.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a ScoreSubGroup object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subgroup</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – A dictionary describing the subgroup as generated by
<a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.sgtbx.lattice_symmetry.html#cctbx.sgtbx.lattice_symmetry.metric_subgroups" title="(in CCTBX vNone)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cctbx.sgtbx.lattice_symmetry.metric_subgroups</span></code></a>.</p></li>
<li><p><strong>sym_op_scores</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – A list of <a class="reference internal" href="#dials.algorithms.symmetry.cosym.ScoreSymmetryElement" title="dials.algorithms.symmetry.cosym.ScoreSymmetryElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScoreSymmetryElement</span></code></a> objects for each
symmetry element possibly in the lattice symmetry.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.ScoreSubGroup.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#ScoreSubGroup.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.ScoreSubGroup.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary representation of the subgroup scoring.</p>
<dl class="simple">
<dt>The dictionary will contain the following keys:</dt><dd><ul class="simple">
<li><p>patterson_group: The current subgroup</p></li>
<li><p>likelihood: The likelihood of the subgroup being correct</p></li>
<li><p>confidence: The confidence of the subgroup being correct</p></li>
<li><p>z_cc_for: The combined Z-scores for all symmetry elements present in the
subgroup</p></li>
<li><p>z_cc_against: The combined Z-scores for all symmetry elements present in
the lattice group but not in the subgroup</p></li>
<li><p>z_cc_net: The net Z-score, i.e. z_cc_for - z_cc_against</p></li>
<li><p>max_angular_difference: The maximum angular difference between the
symmetrised unit cell and the P1 unit cell.</p></li>
<li><p>cb_op: The change of basis operation from the input unit cell to the
‘best’ unit cell.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.ScoreSubGroup.stars">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stars</span></span><a class="headerlink" href="#dials.algorithms.symmetry.cosym.ScoreSubGroup.stars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.ScoreSymmetryElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.cosym.</span></span><span class="sig-name descname"><span class="pre">ScoreSymmetryElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc_true</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#ScoreSymmetryElement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.ScoreSymmetryElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Analyse intensities for presence of a given symmetry operation.</p>
<ol class="arabic simple">
<li><p>Calculate the probability of observing this CC if the sym op is present,
p(CC; S), modelled by a Cauchy distribution centred on cc_true and width
gamma = sigma_cc.</p></li>
<li><p>Calculate the probability of observing this CC if the sym op is
NOT present, p(CC; !S).</p></li>
<li><p>Calculate the likelihood of symmetry element being present,
p(S; CC) = p(CC; S) / (p(CC; S) + p(CC; !S))</p></li>
</ol>
<p>See appendix A1 of <a class="reference external" href="https://doi.org/10.1107/S090744491003982X">Evans, P. R. (2011). Acta Cryst. D67, 282-292.</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.ScoreSymmetryElement.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_cc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc_true</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#ScoreSymmetryElement.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.ScoreSymmetryElement.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a ScoreSymmetryElement object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the correlation coefficient for this symmetry element</p></li>
<li><p><strong>sigma_cc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the estimated error in the correlation coefficient</p></li>
<li><p><strong>cc_true</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the expected value of CC if the symmetry element is present,
E(CC; S)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.ScoreSymmetryElement.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#ScoreSymmetryElement.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.ScoreSymmetryElement.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary representation of the symmetry element scoring.</p>
<dl class="simple">
<dt>The dictionary will contain the following keys:</dt><dd><ul class="simple">
<li><p>likelihood: The likelihood of the symmetry element being present</p></li>
<li><p>z_cc: The Z-score for the correlation coefficient</p></li>
<li><p>cc: The correlation coefficient for the symmetry element</p></li>
<li><p>operator: The xyz representation of the symmetry element</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.ScoreSymmetryElement.stars">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stars</span></span><a class="headerlink" href="#dials.algorithms.symmetry.cosym.ScoreSymmetryElement.stars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.SymmetryAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.cosym.</span></span><span class="sig-name descname"><span class="pre">SymmetryAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_ops</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subgroups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cb_op_inp_min</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#SymmetryAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.SymmetryAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.SymmetryAnalysis.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_ops</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subgroups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cb_op_inp_min</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#SymmetryAnalysis.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.SymmetryAnalysis.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.SymmetryAnalysis.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#SymmetryAnalysis.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.SymmetryAnalysis.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary representation of the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.SymmetryAnalysis.subgroups_table">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subgroups_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#SymmetryAnalysis.subgroups_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.SymmetryAnalysis.subgroups_table" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.SymmetryAnalysis.summary_table">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">summary_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#SymmetryAnalysis.summary_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.SymmetryAnalysis.summary_table" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.SymmetryAnalysis.sym_ops_table">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sym_ops_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#SymmetryAnalysis.sym_ops_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.SymmetryAnalysis.sym_ops_table" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.extract_reference_intensities">
<span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.cosym.</span></span><span class="sig-name descname"><span class="pre">extract_reference_intensities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">iotbx.phil.scope_extract</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">miller.array</span></span></span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym.html#extract_reference_intensities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.extract_reference_intensities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<span class="target" id="module-dials.algorithms.symmetry.cosym.target"></span><p>Target function for cosym analysis.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.target.Target">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.cosym.target.</span></span><span class="sig-name descname"><span class="pre">Target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_pairs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/target.html#Target"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.target.Target" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Target function for cosym analysis.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.target.Target.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><a class="headerlink" href="#dials.algorithms.symmetry.cosym.target.Target.dim" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of dimensions used in the analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.target.Target.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_pairs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/target.html#Target.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.target.Target.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a Target object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>intensities</strong> (<a class="reference external" href="https://cctbx.github.io/cctbx/cctbx.miller.html#cctbx.miller.array" title="(in CCTBX vNone)"><em>cctbx.miller.array</em></a>) – The intensities on which to perform
cosym analysis.</p></li>
<li><p><strong>lattice_ids</strong> (<em>np.ndarray</em>) – An array of equal size to
<cite>intensities</cite> which maps each reflection to a given lattice (dataset).</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Optionally include weights in the target function.
Allowed values are <cite>None</cite>, “count” and “standard_error”. The default
is to use no weights. If “count” is set, then weights are equal to the
number of pairs of reflections used in calculating each value of the
rij matrix. If “standard_error” is used, then weights are defined as
<span class="math notranslate nohighlight">\(w_{ij} = 1/s\)</span>, where <span class="math notranslate nohighlight">\(s = \sqrt{(1-r_{ij}^2)/(n-2)}\)</span>.
See also <a class="reference external" href="http://www.sjsu.edu/faculty/gerstman/StatPrimer/correlation.pdf">http://www.sjsu.edu/faculty/gerstman/StatPrimer/correlation.pdf</a>.</p></li>
<li><p><strong>min_pairs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Only calculate the correlation coefficient between two
datasets if they have more than <cite>min_pairs</cite> of common reflections.</p></li>
<li><p><strong>lattice_group</strong> (<em>cctbx.sgtbx.space_group</em>) – Optionally set the lattice
group to be used in the analysis.</p></li>
<li><p><strong>dimensions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Optionally override the number of dimensions to be used
in the analysis. If not set, then the number of dimensions used is
equal to the greater of 2 or the number of symmetry operations in the
lattice group.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.target.Target.compute_functional">
<span class="sig-name descname"><span class="pre">compute_functional</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/target.html#Target.compute_functional"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.target.Target.compute_functional" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the target function at coordinates <cite>x</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) – a flattened list of the N-dimensional vectors, i.e. coordinates in
the first dimension are stored first, followed by the coordinates in
the second dimension, etc.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the target function at coordinates <cite>x</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>f (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.target.Target.compute_gradients">
<span class="sig-name descname"><span class="pre">compute_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/target.html#Target.compute_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.target.Target.compute_gradients" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the gradients of the target function at coordinates <cite>x</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) – a flattened list of the N-dimensional vectors, i.e. coordinates in
the first dimension are stored first, followed by the coordinates in
the second dimension, etc.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>f: The value of the target function at coordinates <cite>x</cite>.
grad: The gradients of the target function with respect to the parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a>, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.target.Target.compute_gradients_fd">
<span class="sig-name descname"><span class="pre">compute_gradients_fd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/target.html#Target.compute_gradients_fd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.target.Target.compute_gradients_fd" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the gradients at coordinates <cite>x</cite> using finite differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – a flattened list of the N-dimensional vectors, i.e. coordinates in
the first dimension are stored first, followed by the coordinates in
the second dimension, etc.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The value of epsilon to use in finite difference calculations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The gradients of the target function with respect to the parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.target.Target.curvatures">
<span class="sig-name descname"><span class="pre">curvatures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/target.html#Target.curvatures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.target.Target.curvatures" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the curvature of the target function at coordinates <cite>x</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) – a flattened list of the N-dimensional vectors, i.e. coordinates in
the first dimension are stored first, followed by the coordinates in
the second dimension, etc.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The curvature of the target function with respect to the parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>curvs (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.target.Target.curvatures_fd">
<span class="sig-name descname"><span class="pre">curvatures_fd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/target.html#Target.curvatures_fd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.target.Target.curvatures_fd" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the curvatures at coordinates <cite>x</cite> using finite differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – a flattened list of the N-dimensional vectors, i.e. coordinates in
the first dimension are stored first, followed by the coordinates in
the second dimension, etc.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The value of epsilon to use in finite difference calculations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The curvature of the target function with respect to the parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>curvs (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.target.Target.set_dimensions">
<span class="sig-name descname"><span class="pre">set_dimensions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/target.html#Target.set_dimensions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.target.Target.set_dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the number of dimensions for analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dimensions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – The number of dimensions to be used.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-dials.algorithms.symmetry.cosym.engine"></span><p>LBFGS refinement engine for cosym analysis.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.engine.lbfgs_with_curvs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.cosym.engine.</span></span><span class="sig-name descname"><span class="pre">lbfgs_with_curvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_curvatures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">termination_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/engine.html#lbfgs_with_curvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.engine.lbfgs_with_curvs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Minimise a target function using the LBFGS minimiser.</p>
<p>Implementation of an LBFGS minimiser using curvature information, according
to the interface defined by <a class="reference external" href="https://cctbx.github.io/scitbx/scitbx.lbfgs.html#module-scitbx.lbfgs" title="(in CCTBX vNone)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scitbx.lbfgs</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.engine.lbfgs_with_curvs.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_curvatures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">termination_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/engine.html#lbfgs_with_curvs.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.engine.lbfgs_with_curvs.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise an lbfgs_with_curvs object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>dials.algorithms.target.Target</em>) – The target function to minimise.</p></li>
<li><p><strong>coords</strong> (<em>np.ndarray</em>) – The starting coordinates for minimisation.</p></li>
<li><p><strong>use_curvatures</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Whether or not to use curvature information in the
minimisation. Defaults to True.</p></li>
<li><p><strong>termination_params</strong> (<a class="reference external" href="https://cctbx.github.io/scitbx/scitbx.lbfgs.html#scitbx.lbfgs.termination_parameters" title="(in CCTBX vNone)"><em>scitbx.lbfgs.termination_parameters</em></a>) – Override the default termination parameters for the minimisation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.engine.lbfgs_with_curvs.callback_after_step">
<span class="sig-name descname"><span class="pre">callback_after_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minimizer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/engine.html#lbfgs_with_curvs.callback_after_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.engine.lbfgs_with_curvs.callback_after_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Log progress after each successful step of the minimisation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.engine.lbfgs_with_curvs.compute_functional_and_gradients">
<span class="sig-name descname"><span class="pre">compute_functional_and_gradients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/engine.html#lbfgs_with_curvs.compute_functional_and_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.engine.lbfgs_with_curvs.compute_functional_and_gradients" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the functional and gradients.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple of the functional and gradients.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.engine.lbfgs_with_curvs.compute_functional_gradients_and_curvatures">
<span class="sig-name descname"><span class="pre">compute_functional_gradients_and_curvatures</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/engine.html#lbfgs_with_curvs.compute_functional_gradients_and_curvatures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.engine.lbfgs_with_curvs.compute_functional_gradients_and_curvatures" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the functional, gradients and curvatures.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple of the functional, gradients and curvatures.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.engine.lbfgs_with_curvs.compute_functional_gradients_diag">
<span class="sig-name descname"><span class="pre">compute_functional_gradients_diag</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/engine.html#lbfgs_with_curvs.compute_functional_gradients_diag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.engine.lbfgs_with_curvs.compute_functional_gradients_diag" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the functional, gradients and diagonal.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple of the functional, gradients and diagonal, where the
diagonal is the reciprocal of the curvatures.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.engine.minimize_scipy">
<span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.cosym.engine.</span></span><span class="sig-name descname"><span class="pre">minimize_scipy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L-BFGS-B'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_calls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/engine.html#minimize_scipy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.engine.minimize_scipy" title="Permalink to this definition">¶</a></dt>
<dd><p>Thin wrapper around scipy.optimize.minimize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>dials.algorithms.target.Target</em>) – The target function to minimise.</p></li>
<li><p><strong>coords</strong> (<em>np.array</em>) – The starting coordinates for
minimisation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dials.algorithms.symmetry.cosym.engine.minimize_scitbx_lbfgs">
<span class="sig-prename descclassname"><span class="pre">dials.algorithms.symmetry.cosym.engine.</span></span><span class="sig-name descname"><span class="pre">minimize_scitbx_lbfgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_curvatures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_calls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/dials/algorithms/symmetry/cosym/engine.html#minimize_scitbx_lbfgs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dials.algorithms.symmetry.cosym.engine.minimize_scitbx_lbfgs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><!--<h3>Navigation</h3>-->
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto.html">How-to</a></li>
<li class="toctree-l1"><a class="reference external" href="https://dials.github.io/kb">Knowledge Base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../workshops/index.html">Workshops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer container">
  <a href="https://www.diamond.ac.uk/"><img class="logofooter" alt="Diamond" src="../../../_static/diamond_logo.png" /></a>
  <a href="https://www.ccp4.ac.uk/"><img class="logofooter" alt="CCP4" src="../../../_static/CCP4-logo-plain.png" /></a>
  <a href="https://www.stfc.ac.uk/"><img class="logofooter" alt="STFC" src="https://dials.github.io/images/logos/ukri-stfc.png" /></a>
  <a href="https://www.lbl.gov/"><img class="logofooter" alt="LBL" src="https://dials.github.io/images/logos/lbl.png" /></a>
  <a href="http://smb.slac.stanford.edu/"><img class="logofooter" alt="SSRL/SMB" src="https://dials.github.io/images/logos/smbssrl.jpg" /></a>
  </div>

  <script type="text/javascript">
     $(document).ready(function() {
         $(".toggle > *").hide();
         $(".toggle .header").show();
         $(".toggle .header").click(function() {
             $(this).parent().children().not(".header").toggle(400);
             $(this).parent().children(".header").toggleClass("open");
         })
     });
  </script>
  
    <div class="footer">
      &copy;2022, Diamond Light Source, Lawrence Berkeley National Laboratory and STFC.
      
    </div>

    

    

  </body>
</html>